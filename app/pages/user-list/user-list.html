<!--
  Generated template for the UserListPage page.

  See http://ionicframework.com/docs/v2/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-navbar>
    <button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title>People
      <!-- <button (click)="updateUserThumbs()" round clear icon-only>
        <ion-icon name="refresh"></ion-icon>
      </button> -->
    </ion-title>

  </ion-navbar>
  <ion-item>
    <ion-label>Search by:</ion-label>
    <ion-select [(ngModel)]="search">
      <ion-option value="Name" selected="true">Name</ion-option>
      <ion-option value="Job">Job Title</ion-option>
      <ion-option value="Department">Department</ion-option>
    </ion-select>
  </ion-item>
  <ion-searchbar color="primary" [debounce]=300 (ionInput)="searchUser($event)">
  </ion-searchbar>
</ion-header>

<ion-content class="outer-content">
<!--<ion-content class="outer-content" (click)="hideKeyboard()">-->
  <ion-list class="user-list">
    <ion-card *ngFor="let user of users" class="user">
      <ion-card-header>
        <ion-item>
          <ion-avatar item-left>
            <img src="img/user.svg" *ngIf="!userThumbs[user.userPrincipalName]" />
            <img [src]="sanitize(userThumbs[user.userPrincipalName])" *ngIf="userThumbs[user.userPrincipalName]" />
                <!--<img  [src]="sanitize(profilepic)">-->
          </ion-avatar>
          {{user.displayName}}
        </ion-item>
      </ion-card-header>
      <ion-card-content class="outer-content">
        <ion-list>
          <ion-item>
            <h3>Email:
              {{user.mail}}</h3>
          </ion-item>
          <ion-item>
            <h3>Mobile:
              {{user.mobilePhone}}</h3>
          </ion-item>
          <ion-item *ngIf="user.businessPhones[0]">
            <h3>Business Phone:
              {{user.businessPhones[0]}}</h3>
          </ion-item>
          <ion-item *ngIf="user.jobTitle">
            <h3>Job Title:
              {{user.jobTitle}}</h3>
          </ion-item>
          <ion-item *ngIf="user.department">
            <h3>Department:
              {{user.department}}</h3>
          </ion-item>
        </ion-list>
      </ion-card-content>
      <ion-item>
        <button (click)="doImport(user)" round secondary text-center>
          <ion-icon name="person-add"></ion-icon>
          Save
        </button>
        <button (click)="doCall(user)" round secondary text-center>
          <ion-icon name="call"></ion-icon>
          Call
        </button>
        <!--<button (click)="doText(user)" round secondary text-center>-->
        <button (click)="doText(user)" round secondary text-center>
          <ion-icon name="text"></ion-icon>
          <a [href]="sanitize(user.mobilePhone)"> Text </a>
        </button>
        <button (click)="doShare(user)" round secondary text-center>
          <ion-icon name="share"></ion-icon>
          Share
        </button>
      </ion-item>
    </ion-card>
  </ion-list>
  <ion-infinite-scroll threshold="-30%" (ionInfinite)="getNextPage($event)">
    <ion-infinite-scroll-content></ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>
